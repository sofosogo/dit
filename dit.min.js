/* dit | https://github.com/sofosogo/dit | MIT Licensed */(function(){function h(a){var b=a;return typeof a=="string"?(f.innerHTML=a,b=f.firstChild,b._html=a):a.jquery&&(b=a[0]),b&&!b._html&&(b._html=b.outerHTML),b}function i(a,b,c,d,e){var f,g;for(var h in a){f=z(c,h),d&&d[h]!==void 0&&(f=typeof d[h]=="function"?d[h](f,c):d[h]);if(f===void 0&&e)continue;if(f===void 0||f===null)f="";a[h].val=f,g=a[h].handlers;for(var i=0;i<g.length;i++)g[i].fill(f)}}function j(a){var b;for(var c in a){b=a[c].handlers,a[c].val=null;for(var d=0;d<b.length;d++)b[d].clean()}}function k(a,b,c){if(!b)return;if(typeof b=="string")return a[b]=c;for(var d in b)a[d]=b[d]}function l(a){var b={};for(var c in a)A(b,c,a[c].fetch());return b}function m(b,c,d,e,f){if(b.nodeType===3)return o(b,d,f);if(b.nodeType!==1)return;b.getAttribute("bind")&&(f=f.concat(b.getAttribute("bind")),b.removeAttribute("bind")),n(b,d,f),s(b)&&p(b,d,e,f);if(b.getAttribute("each")){var g=[];while(b.hasChildNodes()){var h=b.removeChild(b.firstChild);if(h.nodeType===3&&/^\s*$/.test(h.nodeValue))continue;g.push(h)}var i=g.length>2?g.pop():v(""),j={fill:function(b){this.clean(),b.jquery&&(b=b[0]);if(b.nodeType===11)return this.node.appendChild(b);if(!b||b.length===0)return this.node.appendChild(i);var d=g.length,e;for(var f=0,h=0;f<b.length;f++)e=g[f%d].cloneNode(!0),e=a.create(e,c).fill(b[f]),this.node.appendChild(e)},clean:function(){this.node.innerHTML=""},node:b};u(d,f).push(j);return}var g=[];for(var k=0,l=b.childNodes.length;k<l;k++)g.push(b.childNodes[k]);var h;for(var k=0,l=g.length;k<l;k++)h=g[k],h.nodeType===1?m(h,c,d,e,f):h.nodeType===3&&o(h,d,f)}function n(a,c,d){var e=a.attributes;for(var f=0;f<e.length;f++){var h=e[f].nodeValue,i=[];if(!h||e[f].name==="_html"||typeof h!="string")continue;h.replace(g,function(j,k,l,m,n){l=t(d,l);var o={f:l,m:j},p=e[f].nodeName,p=b[p]?b[p]:p,r={fill:function(b){var d=this._ori,e,f;for(var g=0;g<this._phs.length;g++)e=this._phs[g],f=c[e.f].val,e.convert&&(f=e.convert(f)),d=d.replace(e.m,f);p==="class"?a.className=d:a.setAttribute(p,d)},clean:function(){var b=this._ori.replace(g,"");p==="class"?a.className=b:a.setAttribute(p,b)},_ori:h,_phs:i};m&&(o.convert=q(l,m)),i.push(o),u(c,null,l).push(r)}),i=null}}function o(a,b,c){var d=a.parentNode,e=a.nodeValue,f,h=0;a.nodeValue.replace(g,function(g,i,j,k,l){(f=e.substring(h,l))&&d.insertBefore(v(f),a);var m=v(g),n={fill:function(a){this.convert&&(a=this.convert(a)),a.jquery&&(a=$.map(a.toArray(),function(a){return a}));if(a.nodeType!==1&&!w(a)||!i)a=v(a);var b=this._now;if(w(b)){for(var c=1;c<b.length;c++)d.removeChild(b[c]);b=b[0]}if(w(a))for(var c=0;c<a.length;c++)d.insertBefore(a[c],b);else a&&d.insertBefore(a,b);d.removeChild(b),this._now=a},clean:function(){var a=this._now;if(w(a)){for(var b=1;b<a.length;b++)d.removeChild(a[b]);a=a[0]}d.replaceChild(this._empty,a),this._now=this._empty},_ori:m,_now:m,_empty:v("")};k&&(n.convert=q(j,k)),u(b,c,j).push(n),d.insertBefore(m,a),h=l+g.length}),(f=e.substring(h))&&d.insertBefore(v(f),a),d.removeChild(a)}function p(a,b,d,e){var f=a.name,g=a.type,h=a.getAttribute("number"),i=t(e,f),j=d[i];j||(j=d[i]=new(c[g]||c.normal),u(b,i).push(j)),j.isNum=j.isNum||g==="number"||g==="range"||h!==null,g==="radio"||g==="checkbox"?(j.nodes||(j.nodes=[]),j.nodes.push(a)):j.nodes=a}function q(a,b){return new Function("v","return "+b)}function r(a,b){return b&&(a=parseInt(a)),a!==a?void 0:a}function s(a){var b=a.tagName.toLowerCase();if(b==="input"||b==="textarea"||b==="select"){var c=a.type;return c!=="image"&&c!=="file"&&c!=="button"&&c!=="reset"&&c!=="submit"}return!1}function t(a,b){return w(a)&&(a=a.join(".")),a&&b?a+"."+b:a||b}function u(a,b,c){return c=t(b,c),a[c]||(a[c]={handlers:[]}),a[c].handlers}function v(a){return document.createTextNode(""+a)}function w(a){return a&&d.call(a)==="[object Array]"}function x(a){return a.oldCssText=a.style.cssText,a.style.display="none",a}function y(a){return a.style.cssText=a.oldCssText,a}function z(a,b){if(!a||!b)return null;var c=b.split("."),d=a,e;for(e=0;d&&e<c.length;e++)c[e]&&(d=d[c[e]]);return d}function A(a,b,c){if(!a||!b)return null;var d=b.split("."),e=a,f=d.length;for(var g=0;g<f-1;g++){if(!d[g])continue;e[d[g]]=e[d[g]]||{},e=e[d[g]]}return e[d[f-1]]=c,a}var a=window.dit={create:function(a,b){a=h(a),a._opt=b,a._holders={},a._fields={},m(a,b,a._holders,a._fields,[]);for(var c in this.proto)a[c]=this.proto[c];return a},proto:{fill:function(a,b){return x(this),i(this._holders,this._fields,a||{},this._opt,b),y(this)},append:function(a){return this.fill(a,!0)},clean:function(){return x(this),j(this._holders),y(this)},clone:function(){return this._html?a.create(this._html,this._opt):null},fetch:function(){return l(this._fields)},opt:function(a,b){return k(this._opt,a,b),this}}},b={imgsrc:"src"},c={},d=Object.prototype.toString,e=Array.prototype.join,f=document.createElement("body"),g=/(\$?)\{\{\s*([\w\d\.]+)\s*:?\s*([^}]*)\}\}/ig;c.normal=function(){},c.normal.prototype={fill:function(a){this.nodes.value=a||""},clean:function(){this.nodes.value=""},fetch:function(){return r(this.nodes.value,this.isNum)}},c.radio=function(){},c.radio.prototype={fill:function(a){var b=this.nodes,c=b.length,d=""+a;for(var e=0;e<c;e++)b[e].checked=!1,b[e].value===d&&(b[e].checked=!0)},clean:function(){var a=this.nodes,b=a.length;for(var c=0;c<b;c++)a[c].checked=!1},fetch:function(){var a=this.nodes,b=a.length;for(var c=0;c<b;c++)if(a[c].checked)return r(a[c].value,this.isNum)}},c.checkbox=function(){},c.checkbox.prototype={fill:function(a){var b=this.nodes,c=b.length;!w(a)&&(a=[a]);for(var d=0;d<c;d++){b[d].checked=!1;for(var e=0;a&&e<a.length;e++)b[d].value===""+a[e]&&(b[d].checked=!0)}},clean:function(){var a=this.nodes,b=a.length;for(var c=0;c<b;c++)a[c].checked=!1},fetch:function(){var a=this.nodes,b=a.length,c=[];for(var d=0;d<b;d++)a[d].checked&&c.push(r(a[d].value,this.isNum));return b===1?c[0]:c}},c["select-multiple"]=function(){},c["select-multiple"].prototype={fill:function(a){var b=this.nodes.childNodes,c=b.length;for(var d=0;d<c;d++){if(b[d].nodeType!==1)continue;b[d].setAttribute("selected",""),b[d].selected=!1;for(var e=0;a&&e<a.length;e++)b[d].nodeType===1&&b[d].value===a[e]&&(b[d].setAttribute("selected","true"),b[d].selected=!0)}},clean:function(){var a=this.nodes.childNodes,b=a.length;for(var c=0;c<b;c++)a[c].nodeType===1&&(a[c].setAttribute("selected",""),a[c].selected=!1)},fetch:function(){var a=this.nodes.childNodes,b=a.length,c=[];for(var d=0;d<b;d++)a[d].nodeType===1&&a[d].selected&&(val=a[d].value,c.push(r(a[d].value,this.isNum)));return c}}})()